The types in proto and calc/write need fixing
